# represent experiments config:
runs: 1
run_id: 0
seed: 0
device: 'cpu'
epochs: 2
batch_size: 64

# for logging and tracking the experiments
use_wandb: False
use_json: False
log_freq_every_n_task: 1
wandb:
  project: 'basic_training'
  entity: ''


# data to use
data:
  dataset: 'MNIST'
  use_torchvision: True
  data_path: './data'
  num_classes: 10


# network architecture:
net:
  type: 'deep_ffnn'
  network_class: 'fc'
  netparams:
    input_size: 784
    num_features: 256
    num_outputs: ${data.num_classes}
    num_hidden_layers: 2
    act_type: 'relu'
    initialization: 'xavier'


# learning algorithm:
learner:
  type: 'rr_cbp'
  network_class: ${net.network_class}
  init: 'kaiming'
  device: ${device}
  opt: 'adam'
  loss: 'cross_entropy'
  step_size: 0.001
  beta_1: 0.9
  beta_2: 0.999
  weight_decay: 0.0
  to_perturb: false
  perturb_scale: 0.0
  momentum: 0.0
  neurons_replacement_rate: 0.1
  decay_rate_utility_track: 0.9
  maturity_threshold: 10
  util_type: 'contribution'
  accumulate: False
  diag_sigma_only: True
  sigma_ema_beta: 0.0
  sigma_ridge: 1e-3
  max_proj_trials: 4
  proj_eps: 1e-6
  center_bias: 'mean'
  nullspace_seed_epsilon: 0.0
  orthonormalize_batch: True
  improve_conditioning_if_saturated: True
  log_rank_metrics_every: 1

# evaluation configuration
evaluation:
  use_testset: False
  eval_freq_epoch: 1
  eval_metrics: ['accuracy', 'loss']
  # save_dir: '/results/results_raw' # If not provided, will be created inside the experiment folder,assume root directory is the root of the experiments
  # save_name: 'basic_training'
